use uuid;

// EFI System GPT partition type UUID
export const gpt_efi_system: uuid::uuid = [
	0xC1, 0x2A, 0x73, 0x28, 0xF8, 0x1F, 0x11, 0xD2,
	0xBA, 0x4B, 0x00, 0xA0, 0xC9, 0x3E, 0xC9, 0x3B,
];

const gpt_partnames: [_](str, str) = [
	("024dee41-33e7-11d3-9d69-0008c781f39f", "MBR partition scheme"),
	("0394ef8b-237e-11e1-b4b3-e89a8f7fc3a7", "MidnightBSD UFS"),
	("0657fd6d-a4ab-43c4-84e5-0933c84b4f4f", "Linux swap"),
	("0fc63daf-8483-4772-8e79-3d69d8477de4", "Linux filesystem"),
	("21686148-6449-6e6f-744e-656564454649", "BIOS boot"),
	("2c7357ed-ebd2-46d9-aec1-23d437ec2bf5", "Linux root verity (x86-64)"),
	("2db519c4-b10e-11dc-b99b-0019d1879648", "NetBSD concatenated"),
	("2db519ec-b10e-11dc-b99b-0019d1879648", "NetBSD encrypted"),
	("2e0a753d-9e48-43b0-8337-b15192cb1b5e", "ChromeOS reserved"),
	("2e54b353-1271-4842-806f-e436d6af6985", "HiFive Unleashed BBL"),
	("37affc90-ef7d-4e96-91c3-2d7ae055b174", "IBM General Parallel Fs"),
	("381cfccc-7288-11e0-92ee-000c2911d0b2", "VMware Virtual SAN"),
	("3b8f8425-20e0-4f3b-907f-1a25a76f98e8", "Linux server data"),
	("3cb8e202-3b7e-47dd-8a3c-7ff2a13cfcec", "ChromeOS root fs"),
	("426f6f74-0000-11aa-aa11-00306543ecac", "Apple boot"),
	("4301d2a6-4e3b-4b2a-bb94-9e0b2c4225ea", "Linux /usr (IA-64)"),
	("44479540-f297-41b2-9af7-d131d5f0458a", "Linux root (x86)"),
	("45b0969e-9b03-4f30-b4c6-5ec00ceff106", "Ceph Encrypted Journal"),
	("45b0969e-9b03-4f30-b4c6-b4b80ceff106", "Ceph Journal"),
	("48465300-0000-11aa-aa11-00306543ecac", "Apple HFS/HFS+"),
	("49f48d32-b10e-11dc-b99b-0019d1879648", "NetBSD swap"),
	("49f48d5a-b10e-11dc-b99b-0019d1879648", "NetBSD FFS"),
	("49f48d82-b10e-11dc-b99b-0019d1879648", "NetBSD LFS"),
	("49f48daa-b10e-11dc-b99b-0019d1879648", "NetBSD RAID"),
	("4c616265-6c00-11aa-aa11-00306543ecac", "Apple label"),
	("4d21b016-b534-45c2-a9fb-5c16e091fd2d", "Linux variable data"),
	("4f68bce3-e8cd-4db1-96e7-fbcaf984b709", "Linux root (x86-64)"),
	("4fbd7e29-9d25-41b8-afd0-062c0ceff05d", "Ceph OSD"),
	("4fbd7e29-9d25-41b8-afd0-5ec00ceff05d", "Ceph crypt OSD"),
	("516e7cb4-6ecf-11d6-8ff8-00022d09712b", "FreeBSD data"),
	("516e7cb5-6ecf-11d6-8ff8-00022d09712b", "FreeBSD swap"),
	("516e7cb6-6ecf-11d6-8ff8-00022d09712b", "FreeBSD UFS"),
	("516e7cb8-6ecf-11d6-8ff8-00022d09712b", "FreeBSD Vinum"),
	("516e7cba-6ecf-11d6-8ff8-00022d09712b", "FreeBSD ZFS"),
	("52414944-0000-11aa-aa11-00306543ecac", "Apple RAID"),
	("52414944-5f4f-11aa-aa11-00306543ecac", "Apple RAID offline"),
	("5265636f-7665-11aa-aa11-00306543ecac", "Apple TV recovery"),
	("53746f72-6167-11aa-aa11-00306543ecac", "Apple Core storage"),
	("55465300-0000-11aa-aa11-00306543ecac", "Apple UFS"),
	("5808c8aa-7e8f-42e0-85d2-e1e90434cfb3", "Microsoft LDM metadata"),
	("5b193300-fc78-40cd-8002-e86c45580b47", "HiFive Unleashed FSBL"),
	("69dad710-2ce4-4e3c-b16c-21a1d49abed3", "Linux root (ARM)"),
	("6a491e03-3be7-4545-8e38-83320e0ea880", "Linux /usr verity (IA-64)"),
	("6a82cb45-1dd2-11b2-99a6-080020736631", "Solaris boot"),
	("6a85cf4d-1dd2-11b2-99a6-080020736631", "Solaris root"),
	("6a87c46f-1dd2-11b2-99a6-080020736631", "Solaris swap"),
	("6a898cc3-1dd2-11b2-99a6-080020736631", "Solaris /usr & Apple ZFS"),
	("6a8b642b-1dd2-11b2-99a6-080020736631", "Solaris backup"),
	("6a8d2ac7-1dd2-11b2-99a6-080020736631", "Solaris reserved 5"),
	("6a8ef2e9-1dd2-11b2-99a6-080020736631", "Solaris /var"),
	("6a90ba39-1dd2-11b2-99a6-080020736631", "Solaris /home"),
	("6a9283a5-1dd2-11b2-99a6-080020736631", "Solaris alternate sector"),
	("6a945a3b-1dd2-11b2-99a6-080020736631", "Solaris reserved 1"),
	("6a96237f-1dd2-11b2-99a6-080020736631", "Solaris reserved 4"),
	("6a9630d1-1dd2-11b2-99a6-080020736631", "Solaris reserved 2"),
	("6a980767-1dd2-11b2-99a6-080020736631", "Solaris reserved 3"),
	("6e11a4e7-fbca-4ded-b9e9-e1a512bb664e", "Linux /usr verity (ARM-64)"),
	("7386cdf2-203c-47a9-a498-f2ecce45a2d6", "Linux root verity (ARM)"),
	("7412f7d5-a156-4b13-81dc-867174929325", "ONIE boot"),
	("75250d76-8cc6-458e-bd66-bd47cc81a812", "Linux /usr (x86)"),
	("75894c1e-3aeb-11d3-b7c1-7b03a0000000", "HP-UX data"),
	("773f91ef-66d4-49b5-bd83-d683bf40ad16", "Linux user's home"),
	("77719a0c-a4a0-11e3-a47e-000c29745a24", "VMware Virsto"),
	("77ff5f63-e7b6-4633-acf4-1565b864c0e6", "Linux /usr verity (x86-64)"),
	("7c3457ef-0000-11aa-aa11-00306543ecac", "Apple APFS"),
	("7d0359a3-02b3-4f0a-865c-654403e70625", "Linux /usr (ARM)"),
	("7ec6f557-3bc5-4aca-b293-16ef5df639d1", "Linux temporary data"),
	("7ffec5c9-2d00-49b7-8941-3ea10a5586b7", "Linux plain dm-crypt"),
	("824cc7a0-36a8-11e3-890a-952519ad3f61", "OpenBSD data"),
	("83bd6b9d-7f41-11dc-be0b-001560b84f0f", "FreeBSD boot"),
	("8484680c-9521-48c6-9c11-b0720656f69e", "Linux /usr (x86-64)"),
	("85d5e45a-237c-11e1-b4b3-e89a8f7fc3a7", "MidnightBSD data"),
	("85d5e45b-237c-11e1-b4b3-e89a8f7fc3a7", "MidnightBSD swap"),
	("85d5e45c-237c-11e1-b4b3-e89a8f7fc3a7", "MidnightBSD Vinum"),
	("85d5e45d-237c-11e1-b4b3-e89a8f7fc3a7", "MidnightBSD ZFS"),
	("85d5e45e-237c-11e1-b4b3-e89a8f7fc3a7", "MidnightBSD boot"),
	("86ed10d5-b607-45bb-8957-d350f23d0571", "Linux root verity (IA-64)"),
	("89c57f98-2fe5-4dc0-89c1-5ec00ceff2be", "Ceph crypt disk in creation"),
	("89c57f98-2fe5-4dc0-89c1-f3ad0ceff2be", "Ceph disk in creation"),
	("8da63339-0007-60c0-c436-083ac8230908", "Linux reserved"),
	("8f461b0d-14ee-4e81-9aa9-049b6fb97abd", "Linux /usr verity (x86)"),
	("9198effc-31c0-11db-8f78-000c2911d1b8", "VMware Reserved"),
	("933ac7e1-2eb4-4f13-b844-0e14e2aef915", "Linux home"),
	("993d8d3d-f80e-4225-855a-9daf8ed7ea97", "Linux root (IA-64)"),
	("9d275380-40ad-11db-bf97-000c2911d1b8", "VMware Diagnostic"),
	("9e1a2d38-c612-4316-aa26-8b49521e5a8b", "PowerPC PReP boot"),
	("a19d880f-05fc-4d3b-a006-743f0f84911e", "Linux RAID"),
	("aa31e02a-400f-11db-9590-000c2911d1b8", "VMware VMFS"),
	("af9b60a0-1431-4f62-bc68-3311714a69ad", "Microsoft LDM data"),
	("b0e01050-ee5f-4390-949a-9101b17104e9", "Linux /usr (ARM-64)"),
	("b921b045-1df0-41c3-af44-4c6f280d3fae", "Linux root (ARM-64)"),
	("bc13c2ff-59e6-4262-a352-b275fd6f7172", "Linux extended boot"),
	("bfbfafe7-a34f-448a-9a5b-6213eb736c22", "Lenovo boot partition"),
	("c12a7328-f81f-11d2-ba4b-00a0c93ec93b", "EFI System"),
	("c215d751-7bcd-4649-be90-6627490a4c05", "Linux /usr verity (ARM)"),
	("c91818f9-8025-47af-89d2-f030d7000c2c", "Plan 9 partition"),
	("ca7d7ccb-63ed-4c53-861c-1742536059cc", "Linux LUKS"),
	("cef5a9ad-73bc-4601-89f3-cdeeeee321a1", "QNX6 file system"),
	("d13c5d3b-b5d1-422a-b29f-9454fdc89d76", "Linux root verity (x86)"),
	("d3bfe2de-3daf-11df-ba40-e3a556d89593", "Intel Fast Flash"),
	("d4e6e2cd-4469-46f3-b5cb-1bff57afc149", "ONIE config"),
	("de94bba4-06d1-4d40-a16a-bfd50179d6ac", "Windows recovery environment"),
	("df3300ce-d69f-4c92-978c-9bfb0f38d820", "Linux root verity (ARM-64)"),
	("e2a1e728-32e3-11d6-a682-7b03a0000000", "HP-UX service"),
	("e3c9e316-0b5c-4db8-817d-f92df00215ae", "Microsoft reserved"),
	("e6d6d379-f507-44c2-a23c-238f2a3df928", "Linux LVM"),
	("e75caf8f-f680-4cee-afa3-b001e56efc2d", "Microsoft Storage Spaces"),
	("ebd0a0a2-b9e5-4433-87c0-68b6b72699c7", "Microsoft basic data"),
	("f4019732-066e-4e12-8273-346c5641494f", "Sony boot partition"),
	("fe3a2a5d-4f32-41a7-b725-accc3285a309", "ChromeOS kernel"),
];

// Returns the name for the given partition type, if known, or returns the UUID
// as-is otherwise.
export fn gpt_typename(uuid: uuid::uuid) const str = {
	const ustr = uuid::encodestr(uuid);
	// TODO: bsearch (why am I always this lazy)
	for (let i = 0z; i < len(gpt_partnames); i += 1) {
		const (u, n) = gpt_partnames[i];
		if (u == ustr) {
			return n;
		};
	};
	return ustr;
};
